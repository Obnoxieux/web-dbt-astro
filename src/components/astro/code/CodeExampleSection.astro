---
import CodeBlock from "./CodeBlock.astro";
import { type CodeSampleItem } from "../../../lib/codeSamples.ts";

interface Props {
    codeSamples: CodeSampleItem[];
}

const { codeSamples } = Astro.props;
---

<div
    class="card lg:card-side w-full bg-base-200 border-2 border-neutral-content shadow-xl my-4"
>
    <div class="card-body">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-2 lg:gap-8">
            <div>
                <h2 class="card-title">Languages</h2>
                <p class="my-3">that I use and sometimes love</p>

                <div
                    role="tablist"
                    class="tabs tabs-lifted mb-4 border-1 rounded-lg border-neutral-content"
                >
                    {
                        codeSamples.map((codeSample, index) => (
                            <button
                                class={`tab ${index === 0 ? "tab-active" : ""}`}
                                data-tab={codeSample.languageType}
                            >
                                {codeSample.languageType}
                            </button>
                        ))
                    }
                </div>
            </div>

            <div class="sample-container lg:col-span-2">
                {
                    codeSamples.map((codeSample, index) => (
                        <div
                            class={`code-content ${index === 0 ? "active" : ""}`}
                            data-lang={codeSample.languageType}
                        >
                            <CodeBlock
                                lang={codeSample.languageType}
                                code={codeSample.text}
                            />
                        </div>
                    ))
                }
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const tabs = document.querySelectorAll("[data-tab]");
        const codeContents = document.querySelectorAll(".code-content");

        tabs.forEach((tab) => {
            tab.addEventListener("click", (event) => {
                event.preventDefault();
                event.stopPropagation();

                const targetLang = tab.getAttribute("data-tab");

                tabs.forEach((t) => t.classList.remove("tab-active"));
                tab.classList.add("tab-active");

                codeContents.forEach((content) => {
                    content.classList.remove("active");
                });

                const targetContent = document.querySelector(
                    `[data-lang="${targetLang}"]`,
                );
                if (targetContent) {
                    setTimeout(() => {
                        targetContent.classList.add("active");
                    }, 50);
                }
            });
        });
    });
</script>

<style>
    .sample-container {
        position: relative;
        min-height: 500px;
    }

    .code-content {
        opacity: 0;
        transform: translateX(-20px);
        transition:
            opacity 0.3s ease,
            transform 0.3s ease;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        visibility: hidden;
    }

    .code-content.active {
        opacity: 1;
        transform: translateX(0);
        position: absolute;
        visibility: visible;
        animation: slideIn 0.3s ease forwards;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
</style>
